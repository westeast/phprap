{{include_file name='home/public/header' title='账户设置'}}

</head>

<body>

<div id="wrapper">

    <!-- Navigation -->
    {{include_file name='home/public/nav' sidebar='home/account/sidebar' active='profile'}}
    <div id="page-wrapper">
        <div class="row">
            <div class="col-lg-12">
                <div class="page-header">
                    <h1>账户设置 </h1>
                </div>
            </div>
            <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->
        <div class="row">

            <div class="col-lg-12">

                <div class="panel panel-default">

                    {{include_file name='home/account/tab' tab='account'}}

                    <div class="panel-body">
                        <form role="form" id="js_settingForm" action="{{url('')}}" method="post">
                            <input type="hidden" name="csrf-phprap" value="{{csrf_token()}}" />

                            <div class="form-group">
                                <label class="control-label">用户昵称</label>
                                <input type="text" class="form-control js_name" name="UpdateForm[name]" value="{{$user->name}}" placeholder="必填，建议写真实姓名以方便识别" datatype="*2-10" nullmsg="请输入用户昵称" errormsg="请输入2-10个由字母或汉字组成的字符">
                            </div>

                            <div class="form-group">
                                <label class="control-label">登录邮箱</label>
                                <input type="text" class="form-control js_email" name="UpdateForm[email]" value="{{$user->email}}" placeholder="必填，该邮箱用于登录和接收通知" datatype="e" nullmsg="请输入登录邮箱" errormsg="请输入合法的邮箱地址">
                            </div>

                            <div class="form-group">
                                <label class="control-label">登录密码</label>
                                <input type="password" class="form-control js_password" name="UpdateForm[password]" placeholder="登录密码6-20个字符，不修改请留空，修改密码后需重新登录" autocomplete="off" ignore="ignore" datatype="*6-20" nullmsg="请填写登录密码" errormsg="请填写6-20个字符">
                            </div>

                            <div class="form-group">
                                <label class="control-label">确认密码</label>
                                <input type="password" class="form-control" placeholder="再次输入密码，不修改请留空" autocomplete="off" ignore="ignore" datatype="*" recheck="UpdateForm[password]" nullmsg="请输入确认密码" errormsg="两次密码输入不一致">
                            </div>

                            <button type="reset" class="btn btn-default mr-1">重置</button>
                            <button type="button" class="btn btn-primary js_submit">确认</button>

                        </form>

                    </div>
                    <!-- /.panel-body -->
                </div>
                <!-- /.panel -->
            </div>
            <!-- /.col-lg-12 -->
        </div>

    </div>
    <!-- /#page-wrapper -->

</div>
<!-- /#wrapper -->
<hr>
<p class="text-center">{{config('copyright')}}</p>

<script>
    $(function(){

        var submitBtn = '.js_submit';
        // 添加表单验证
        $("form").Validform({

            tiptype:function(msg,o){

                if(!o.obj.is("form")){

                    if(3 == o.type){
                        alert(msg, 'error');
                    }

                }
            },

            label:"label",

            btnSubmit: submitBtn,

            tipSweep:true,

            ignoreHidden:true,

            ajaxPost:true,

            beforeSubmit: function () {

                $(submitBtn).attr("disabled", "disabled");
            },

            callback:function(json){

//                console.log(json);return;

                if(json.status == 'success'){

                    alert(json.message, 'success', function () {
                        parent.location.reload();
                    });

                }else{

                    $(".js_" + json.label).focus().addClass('Validform_error');
                    $(submitBtn).removeAttr("disabled");
                    alert(json.message, 'error');

                }

            }
        });

    });
</script>
{{include_file name='home/public/footer'}}